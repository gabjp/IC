#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Thu Mar 10 09:35:35 2022

@author: gjperin
"""
#from Tabela04(2) import id_results
from scipy.stats import wilcoxon
import numpy as np

i_results = {'RF_12S':
             {'F-mean': [0.9261571742132274, 0.9210475758439775, 0.9197217506469011, 0.9178483713234137, 0.923972994789721],
              'P_QSO': [0.9256816182937555, 0.9146502419709635, 0.9190497140343159, 0.9234947940244455, 0.9168490153172867], 
              'P_STAR': [0.9606427152915689, 0.9506216696269982, 0.9492740634522315, 0.9586582048957389, 0.9582586886420638], 
              'P_GAL': [0.9143159006867406, 0.9164889078498294, 0.9114246313779569, 0.905075876504448, 0.9156396090097747], 
              'R_QSO': [0.9034334763948498, 0.8918918918918919, 0.8961818961818961, 0.8751608751608752, 0.8987558987558988], 
              'R_STAR': [0.8959420777908739, 0.9011618117528203, 0.8917326149183364, 0.8902172082842229, 0.9005050505050505], 
              'R_GAL': [0.9605949605949606, 0.9538239538239538, 0.9537129537129537, 0.9599289599289599, 0.9567051509769094], 
              'F_QSO': [0.9144222415291051, 0.9031277150304082, 0.9074717636837533, 0.8986784140969164, 0.9077123050259965], 
              'F_STAR': [0.927165011326015, 0.9252312213674474, 0.9196040979336692, 0.9231709446481579, 0.928484638083666], 
              'F_GAL': [0.9368842697845621, 0.9347837911340767, 0.9320893903232806, 0.9316957552251669, 0.9357220412595005]}, 
             'RF_12S+2W':
            {'F-mean': [0.9688510559482174, 0.9686142825282106, 0.9674955434924977, 0.9686549532169787, 0.9686626889861097], 
             'P_QSO': [0.9546044098573282, 0.9526270456503014, 0.9559204840103717, 0.9561060408518036, 0.9548192771084337], 
             'P_STAR': [0.9863387978142076, 0.9853217272572111, 0.9855694897783885, 0.9876859928168291, 0.9858022579541567], 
             'P_GAL': [0.9706883302228565, 0.9716421191470653, 0.9671916010498688, 0.9695542656883145, 0.9692611702711604], 
             'R_QSO': [0.9476394849785408, 0.948948948948949, 0.948948948948949, 0.9438009438009438, 0.9519519519519519], 
             'R_STAR': [0.9725543020710558, 0.9720491665263512, 0.9659875399898973, 0.9723859235561543, 0.9702020202020202], 
             'R_GAL': [0.9814629814629815, 0.9812409812409812, 0.9816849816849816, 0.9826839826839827, 0.9801287744227354], 
             'F_QSO': [0.9511091966401034, 0.9507844401461422, 0.9524219590958019, 0.9499136442141624, 0.9533834586466166], 
             'F_STAR': [0.9793980500211953, 0.9786404475334802, 0.9756802721088436, 0.9799762430001696, 0.9779399287290005], 
             'F_GAL': [0.9760459211833535, 0.9764179599050092, 0.9743843992728475, 0.9760749724366042, 0.9746646795827124]}, 
            'RF_5S':
            {'F-mean': [0.9043298818873233, 0.9011458758296014, 0.8992872434150754, 0.899582599481415, 0.905380254787613], 
             'P_QSO': [0.9127159946832077, 0.9045116075339465, 0.9027169149868537, 0.8999557326250553, 0.9092495636998255], 
             'P_STAR': [0.9187719298245614, 0.9080062251426595, 0.9157820240622788, 0.9294054248248608, 0.9244444444444444], 
             'P_GAL': [0.899581589958159, 0.9023119505047216, 0.8952380952380953, 0.8920977467470644, 0.8979918820764794], 
             'R_QSO': [0.8841201716738197, 0.8858858858858859, 0.8837408837408838, 0.8721578721578721, 0.894036894036894], 
             'R_STAR': [0.881798282539148, 0.884155581747769, 0.8715271931301566, 0.8711904361003536, 0.8754208754208754], 
             'R_GAL': [0.9307359307359307, 0.9227439227439227, 0.9286269286269286, 0.936063936063936, 0.9332815275310835], 
             'F_QSO': [0.8981905384783082, 0.895101863892501, 0.8931281161933666, 0.885838779956427, 0.9015790612156608], 
             'F_STAR': [0.8999054901623852, 0.8959221975772053, 0.8931067207316021, 0.8993568572918478, 0.8992650237786424], 
             'F_GAL': [0.9148936170212766, 0.9124135660190977, 0.9116268933202573, 0.91355216119597, 0.9152966793685358]}, 
            'RF_5S+2W':
            {'F-mean': [0.9667507813648996, 0.9674744005001443, 0.9640738537893482, 0.9653498268701138, 0.9674093496284611], 
             'P_QSO': [0.9508620689655173, 0.9526881720430107, 0.9474134245404019, 0.9477739726027398, 0.9501491265445249], 
             'P_STAR': [0.981010512037979, 0.9837579073345871, 0.9806374228923921, 0.9802586793737236, 0.9814310051107326], 
             'P_GAL': [0.9710816777041943, 0.9695771554091158, 0.9660588752196837, 0.969118782397706, 0.9703156036195101], 
             'R_QSO': [0.9467811158798283, 0.9502359502359502, 0.9506649506649507, 0.9498069498069498, 0.9566709566709567], 
             'R_STAR': [0.9742380872200708, 0.9688499747432228, 0.9636302407812763, 0.9698602458326318, 0.9698653198653199], 
             'R_GAL': [0.9765789765789766, 0.97990897990898, 0.9762459762459762, 0.9753579753579753, 0.9761323268206039], 
             'F_QSO': [0.9488172043010752, 0.9514604810996563, 0.9490364025695932, 0.9487893721877009, 0.953398888413852], 
             'F_STAR': [0.9776125707527246, 0.9762470308788599, 0.9720594479830149, 0.9750317393144308, 0.9756138865368332], 
             'F_GAL': [0.9738225690408987, 0.9747156895219168, 0.9711257108154364, 0.9722283691082098, 0.9732152739346983]}, 
            'SVM_12S':
            {'F-mean': [0.7712393633118224, 0.7727244050107475, 0.7685127996501171, 0.765767803996979, 0.7695469400347182], 
             'P_QSO': [0.9090909090909091, 0.9079143852663016, 0.9094076655052264, 0.9072164948453608, 0.9110772357723578], 
             'P_STAR': [0.759974932107792, 0.7615400538190851, 0.7552901738948251, 0.7657430730478589, 0.7656315568610994], 
             'P_GAL': [0.7370681427753388, 0.7400134112462879, 0.7344955701629037, 0.7328605200945626, 0.7350403034613561], 
             'R_QSO': [0.7854077253218884, 0.7824967824967825, 0.7837837837837838, 0.7550407550407551, 0.7691977691977692], 
             'R_STAR': [0.6125610372116518, 0.6194645563226132, 0.6070045462199023, 0.6142448223606668, 0.6143097643097644], 
             'R_GAL': [0.8572538572538573, 0.8574758574758575, 0.8558108558108558, 0.8602508602508603, 0.8604573712255773], 
             'F_QSO': [0.842735436334331, 0.840552995391705, 0.8419354838709677, 0.8241629594942637, 0.8341474761572459], 
             'F_STAR': [0.678351668842066, 0.6831940575673167, 0.673076923076923, 0.6816780341960198, 0.6816738277601345], 
             'F_GAL': [0.7926309847590702, 0.7944261620732209, 0.7905259920024608, 0.7914624183006536, 0.7928195161867745]}, 
            'SVM_12S+2W': 
            {'F-mean': [0.8951240061414332, 0.9002233271891281, 0.8972762844744914, 0.8962529664974709, 0.8963383918164413], 
             'P_QSO': [0.9495879786718371, 0.9586776859504132, 0.9567120622568094, 0.953662182361734, 0.9548834903321765], 
             'P_STAR': [0.9395313681027967, 0.941320293398533, 0.9439038351459645, 0.949498770569321, 0.945187417592767], 
             'P_GAL': [0.8662702811649703, 0.8712771327612318, 0.8657583650571028, 0.8674011016524787, 0.867678087008942], 
             'R_QSO': [0.8407725321888412, 0.8459888459888459, 0.8438438438438438, 0.8211068211068211, 0.8262548262548263], 
             'R_STAR': [0.8371779760902509, 0.8427344670820003, 0.8329685132177134, 0.8452601448055228, 0.8447811447811447], 
             'R_GAL': [0.9541569541569541, 0.957930957930958, 0.9592629592629592, 0.9613719613719613, 0.9587033747779752], 
             'F_QSO': [0.8918734350102435, 0.8988149498632634, 0.8967403692728515, 0.8824343015214384, 0.8859245630174792], 
             'F_STAR': [0.8854064642507347, 0.8893034825870646, 0.8849731663685151, 0.8943523962230536, 0.8921681927282424], 
             'F_GAL': [0.9080921191633212, 0.9125515491170562, 0.9101153177821073, 0.9119722017479205, 0.9109224197036021]}, 
            'SVM_5S': 
            {'F-mean': [0.786121883663134, 0.7843381853126751, 0.7831496706922199, 0.7805577297901761, 0.7895007044987558], 
             'P_QSO': [0.8986580286904211, 0.8948837209302326, 0.8869129046967624, 0.8906103286384977, 0.9019426456984274], 
             'P_STAR': [0.7451465550057099, 0.7402088772845953, 0.7445423209498276, 0.7479362641581877, 0.7521088957055214], 
             'P_GAL': [0.7596066105647369, 0.7611344322719361, 0.7585158150851582, 0.7551307847082495, 0.7612362387637612], 
             'R_QSO': [0.8334763948497854, 0.8253968253968254, 0.8344058344058344, 0.8138138138138138, 0.8365508365508365], 
             'R_STAR': [0.6592018858393669, 0.6682943256440478, 0.6546556659370264, 0.6560026940562385, 0.6604377104377105], 
             'R_GAL': [0.8316128316128316, 0.8251748251748252, 0.8305028305028305, 0.8331668331668332, 0.8367007104795737], 
             'F_QSO': [0.8648407926965042, 0.8587368890872573, 0.8598585322723253, 0.8504819547186729, 0.8680169152014244], 
             'F_STAR': [0.6995443580809435, 0.7024157154234139, 0.6967117641788371, 0.6989594546106925, 0.703298673359627], 
             'F_GAL': [0.7939805002119542, 0.791861951427354, 0.7928787156254968, 0.7922317800411631, 0.797186524935216]}, 
            'SVM_5S+2W':
            {'F-mean': [0.9509701625606882, 0.9535486682637524, 0.9496934449524878, 0.9494579479306612, 0.9519658766861774],
             'P_QSO': [0.9563063063063063, 0.9568121104185218, 0.9500223114680946, 0.9515042658284688, 0.9539767649687221],
             'P_STAR': [0.9570879946568709, 0.9572406881576749, 0.9595959595959596, 0.9559853284428143, 0.9599530831099196],
             'P_GAL': [0.9554526408644834, 0.9585452133539686, 0.9533963508463399, 0.955489286503203, 0.9556927146478563],
             'R_QSO': [0.9111587982832619, 0.9219219219219219, 0.9133419133419134, 0.909051909051909, 0.9159159159159159],
             'R_STAR': [0.9651456474153898, 0.9649772689004883, 0.9597575349385419, 0.9654824044451928, 0.9644781144781145],
             'R_GAL': [0.9618159618159619, 0.9624819624819625, 0.9628149628149628, 0.9602619602619603, 0.962588809946714],
             'F_QSO': [0.9331868131868132, 0.9390430412934235, 0.9313210848643919, 0.9297937691970162, 0.9345589844604946],
             'F_STAR': [0.9610999329309189, 0.9610934093577059, 0.9596767404663692, 0.9607103962469633, 0.9622102788041652],
             'F_GAL': [0.9586237415643324, 0.9605095541401274, 0.9580825095267024, 0.9578696783480042, 0.9591283667938721]},
             'SVM_12S_P': # Resultados padronizados obtidos de ip_results
              {'F-mean': [0.8761552355381595, 0.8742658028160001, 0.8724646498250562, 0.8700139792748991, 0.8757849190637291],
               'P_QSO': [0.9092159559834938, 0.9010082493125573, 0.9044321329639889, 0.9005137786081271, 0.9095966620305981],
               'P_STAR': [0.9104844814534444, 0.9120317820658342, 0.9129353233830846, 0.9211851278079008, 0.9175415155564038],
               'P_GAL': [0.8553959033934576, 0.8560799103047599, 0.8519267725295843, 0.8478042911570082, 0.8534857836689265],
               'R_QSO': [0.8510729613733906, 0.8434148434148434, 0.8404118404118404, 0.8271128271128271, 0.8416988416988417],
               'R_STAR': [0.8100690351911096, 0.8117528203401246, 0.8033338945950497, 0.8009765953864287, 0.8092592592592592],
               'R_GAL': [0.9317349317349317, 0.9322899322899323, 0.934953934953935, 0.9386169386169386, 0.9363898756660746],
               'F_QSO': [0.8791842163600089, 0.8712608021271881, 0.8712474983322215, 0.8622540250447226, 0.8743315508021391],
               'F_STAR': [0.8573465205381805, 0.8589755011135858, 0.8546350201522614, 0.856885526434297, 0.8600053672063691],
               'F_GAL': [0.8919349697162895, 0.8925611052072263, 0.8915114309906859, 0.8909023863456778, 0.8930178391826795]},
              'SVM_12S+2W_P':
              {'F-mean': [0.9636881757697385, 0.9635712149034473, 0.9621164004261963, 0.9640266651050932, 0.9650632498884528], 
               'P_QSO': [0.953125, 0.9521345407503234, 0.9528750540423692, 0.9560104529616724, 0.9573091849935317], 
               'P_STAR': [0.9777210884353742, 0.9763323684658607, 0.975901555289694, 0.9772263766145479, 0.9776221387085753], 
               'P_GAL': [0.9659115900593798, 0.9659953780125454, 0.9629182665935272, 0.9658204198263546, 0.9646386997584011], 
               'R_QSO': [0.9424892703862661, 0.9472329472329473, 0.9455169455169455, 0.9416559416559417, 0.9523809523809523], 
               'R_STAR': [0.9680080821687153, 0.9654824044451928, 0.9614413200875568, 0.9681764606836167, 0.9634680134680135], 
               'R_GAL': [0.975024975024975, 0.9743589743589743, 0.9742479742479743, 0.9754689754689755, 0.9751332149200711], 
               'F_QSO': [0.9477772982304704, 0.9496774193548387, 0.9491817398794143, 0.948778906418846, 0.9548387096774192], 
               'F_STAR': [0.9728403418224892, 0.9708770741618693, 0.9686174724342663, 0.972680368772731, 0.9704934712565711], 
               'F_GAL': [0.9704468872562558, 0.9701591511936339, 0.9685499889649084, 0.9706207201237023, 0.9698575687313681]}, 
              'SVM_5S_P': 
              {'F-mean': [0.8742462527666861, 0.8734268935448505, 0.8690510964605975, 0.8698120850350776, 0.8755407670702118], 
               'P_QSO': [0.9039599453800637, 0.8960216998191681, 0.8929705215419501, 0.8930530164533821, 0.9021739130434783], 
               'P_STAR': [0.9126529051987767, 0.9114068441064639, 0.9125820146661521, 0.9203264671589584, 0.9198606271777003], 
               'P_GAL': [0.8524723322164687, 0.8553074334658917, 0.8488677719369188, 0.8482654600301659, 0.8527006562342251], 
               'R_QSO': [0.8523605150214593, 0.8502788502788503, 0.8447018447018447, 0.8382668382668382, 0.8545688545688546], 
               'R_STAR': [0.8040074086546557, 0.8072066004377841, 0.7962619969691868, 0.7974406465734972, 0.8], 
               'R_GAL': [0.931956931956932, 0.9310689310689311, 0.932067932067932, 0.9363969363969364, 0.9376110124333925], 
               'F_QSO': [0.87740225314778, 0.8725511776359234, 0.8681657848324515, 0.8647930958176587, 0.8777263714474554], 
               'F_STAR': [0.854892131411691, 0.8561478703455666, 0.8504630878518119, 0.854488046910239, 0.8557536466774717], 
               'F_GAL': [0.8904443737405875, 0.8915816326530612, 0.8885244166975292, 0.8901551123773346, 0.8931422830857082]}, 
              'SVM_5S+2W_P': 
              {'F-mean': [0.9651302925809806, 0.9661561143912841, 0.9638497288175499, 0.9652388240434512, 0.9649322642513719], 
               'P_QSO': [0.9491452991452991, 0.9508966695132366, 0.9516474112109542, 0.9519725557461407, 0.9485981308411215], 
               'P_STAR': [0.9765982703069357, 0.9769021739130435, 0.9764062232860318, 0.9767204757858964, 0.9770095367847411], 
               'P_GAL': [0.9693617962614755, 0.9704939772350536, 0.9652479929616188, 0.9684396380489958, 0.9677454987297028], 
               'R_QSO': [0.9532188841201716, 0.9553839553839554, 0.954096954096954, 0.9523809523809523, 0.9579579579579579], 
               'R_STAR': [0.9696918673177303, 0.9685132177134198, 0.9616096986024584, 0.9678397036538138, 0.9658249158249158], 
               'R_GAL': [0.9728049728049728, 0.9748029748029748, 0.9742479742479743, 0.9741369741369741, 0.9725799289520426], 
               'F_QSO': [0.9511777301927195, 0.9531350310293174, 0.9528706083976006, 0.9521767102723568, 0.9532550693703308], 
               'F_STAR': [0.9731328151402501, 0.9726896085228713, 0.9689514760773669, 0.9722598105548037, 0.971385032170674], 
               'F_GAL': [0.9710803324099723, 0.9726437036216636, 0.969727101977682, 0.9712799513031929, 0.9701566912131111]},
              'RF_12S+4M':
              {'F-mean': [0.9621750895873408, 0.9602982809576238, 0.9593089737368063, 0.9594405299809372, 0.9608491517286994], 
               'P_QSO': [0.935930735930736, 0.9276485788113695, 0.9313938341293965, 0.93, 0.9305135951661632], 
               'P_STAR': [0.9834583901773534, 0.9836372933356059, 0.9832678845825508, 0.9866438356164383, 0.9856238233784015],
               'P_GAL': [0.9723198594024605, 0.9730473047304731, 0.9698431845597105, 0.9692526534631798, 0.9713784406184889],
               'R_QSO': [0.9278969957081545, 0.924066924066924, 0.9202059202059202, 0.9176319176319176, 0.924924924924925],
               'R_STAR': [0.9710388954369422, 0.9717124094965482, 0.9696918673177303, 0.9701970028624347, 0.9695286195286196],
               'R_GAL': [0.9825729825729825, 0.9817959817959818, 0.9816849816849816, 0.9832389832389833, 0.9833481349911191],
               'F_QSO': [0.931896551724138, 0.9258542875564152, 0.9257660768234787, 0.9237745627294321, 0.927710843373494],
               'F_STAR': [0.9772091841057358, 0.9776384889039472, 0.9764326890471345, 0.9783513031666525, 0.9775099719935499],
               'F_GAL': [0.9774195329321482, 0.977402066412509, 0.9757281553398058, 0.9761957240467269, 0.9773266398190544]},
              'RF_12S+2W+4M': 
              {'F-mean': [0.9757701590475848, 0.973946586646762, 0.9729164875019491, 0.9744094731407054, 0.9763726920295199],
               'P_QSO': [0.9576017130620985, 0.9528099528099528, 0.9542511868795857, 0.9588031222896791, 0.9532908704883227],
               'P_STAR': [0.992322129329466, 0.9928339873741683, 0.9916482018067155, 0.9941920054663478, 0.9950452759268751],
               'P_GAL': [0.9789693900022022, 0.9785407725321889, 0.977130291368884, 0.9766421756771576, 0.9798258185426083],
               'R_QSO': [0.959656652360515, 0.9528099528099528, 0.9485199485199485, 0.9485199485199485, 0.9631059631059631],
               'R_STAR': [0.9792894426671157, 0.9797945782118201, 0.9796261996969187, 0.9799629567267216, 0.9804713804713805],
               'R_GAL': [0.9869019869019869, 0.987012987012987, 0.9864579864579864, 0.9885669885669885, 0.9866785079928952],
               'F_QSO': [0.9586280814576633, 0.9528099528099527, 0.9513769363166954, 0.9536338149665733, 0.9581732821169441],
               'F_STAR': [0.9857627118644068, 0.986271186440678, 0.9856005420972387, 0.9870262019842279, 0.9877045705079285],
               'F_GAL': [0.9829196838206844, 0.9827586206896552, 0.9817719840919135, 0.982568402471315, 0.9832402234636872]}}

comparisons = [("RF_12S+2W+4M", "RF_12S+2W"),("RF_12S+4M", "RF_12S"),("RF_12S+2W+4M", "RF_12S+4M")]
    
for pair in comparisons:
    print(f"{pair[0]} X {pair[1]}")
    
    for key  in i_results["RF_12S"]:
     
        w, p = wilcoxon(np.array(i_results[pair[0]][key])*100, np.array(i_results[pair[1]][key])*100, mode="exact", alternative="greater")
        if w != 15:
            print(f"{key}: W: {w} p: {p}")
    print("Outros: W: 15 p: 0.3", end= "\n\n")

